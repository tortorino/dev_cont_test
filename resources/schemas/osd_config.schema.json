{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://jettison.com/schemas/osd_config.json",
  "title": "OSD Configuration Schema",
  "description": "JSON Schema for Jettison OSD configuration (Draft-07). Note: Some runtime values like crosshair offset (offset_x/offset_y) come from protobuf state, not this config - see rec_osd.day_crosshair_offset_* and heat_crosshair_offset_* fields.",
  "type": "object",
  "required": ["crosshair", "timestamp", "speed_indicators", "variant_info", "radar_compass", "celestial_indicators"],
  "properties": {
    "crosshair": {
      "type": "object",
      "title": "Crosshair",
      "x-ui-level": "top",
      "x-ui-order": 10,
      "x-ui-collapsed": false,
      "required": ["enabled", "center_dot", "cross", "circle"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "orientation": {
          "type": "string",
          "title": "Orientation",
          "enum": ["vertical", "diagonal"],
          "default": "vertical"
        },
        "center_dot": {
          "type": "object",
          "title": "Center Dot",
          "x-ui-level": "accordion",
          "x-ui-order": 10,
          "required": ["enabled", "radius", "color", "thickness"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "radius": { "type": "number", "title": "Radius", "minimum": 0, "maximum": 50 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 10 }
          }
        },
        "cross": {
          "type": "object",
          "title": "Cross Arms",
          "x-ui-level": "accordion",
          "x-ui-order": 20,
          "required": ["enabled", "length", "gap", "thickness", "color"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "length": { "type": "number", "title": "Length", "minimum": 0, "maximum": 500 },
            "gap": { "type": "number", "title": "Gap", "minimum": 0, "maximum": 100 },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 20 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" }
          }
        },
        "circle": {
          "type": "object",
          "title": "Reference Circle",
          "x-ui-level": "accordion",
          "x-ui-order": 30,
          "required": ["enabled", "radius", "thickness", "color"],
          "properties": {
            "enabled": { "type": "boolean", "title": "Enabled" },
            "radius": { "type": "number", "title": "Radius", "minimum": 0, "maximum": 200 },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 10 },
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" }
          }
        }
      }
    },
    "timestamp": {
      "type": "object",
      "title": "Timestamp",
      "x-ui-level": "top",
      "x-ui-order": 30,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "color", "font_size", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": 0, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": 0, "maximum": 2160 },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "speed_indicators": {
      "type": "object",
      "title": "Speed Indicators",
      "x-ui-level": "top",
      "x-ui-order": 40,
      "x-ui-collapsed": true,
      "required": ["enabled", "color", "font_size", "max_speed_azimuth", "max_speed_elevation", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "threshold": {
          "type": "number",
          "title": "Display Threshold",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.05,
          "description": "Minimum normalized speed (0.0-1.0) to show indicator"
        },
        "max_speed_azimuth": {
          "type": "number",
          "title": "Max Speed Azimuth",
          "minimum": 0.1,
          "maximum": 360.0,
          "default": 35.0,
          "description": "Maximum azimuth speed in degrees/second for normalization"
        },
        "max_speed_elevation": {
          "type": "number",
          "title": "Max Speed Elevation",
          "minimum": 0.1,
          "maximum": 360.0,
          "default": 35.0,
          "description": "Maximum elevation speed in degrees/second for normalization"
        },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "variant_info": {
      "type": "object",
      "title": "Debug Overlay",
      "x-ui-level": "top",
      "x-ui-order": 60,
      "x-ui-collapsed": true,
      "required": ["enabled", "position_x", "position_y", "color", "font_size", "font"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": 0, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": 0, "maximum": 2160 },
        "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
        "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 128 },
        "font": {
          "type": "string",
          "title": "Font",
          "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
          "default": "liberation_sans_bold"
        }
      }
    },
    "radar_compass": {
      "type": "object",
      "title": "Radar Compass",
      "x-ui-level": "top",
      "x-ui-order": 20,
      "x-ui-collapsed": false,
      "description": "2D top-down compass with distance rings, cardinal directions, and FOV wedge. FOV angle comes from camera state at runtime.",
      "required": ["enabled", "position_x", "position_y", "size", "rings", "cardinals", "fov_wedge"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "position_x": { "type": "integer", "title": "Position X", "minimum": -500, "maximum": 3840 },
        "position_y": { "type": "integer", "title": "Position Y", "minimum": -500, "maximum": 2160 },
        "size": { "type": "integer", "title": "Size", "minimum": 50, "maximum": 1000, "description": "Compass diameter in pixels" },
        "rings": {
          "type": "object",
          "title": "Distance Rings",
          "x-ui-level": "accordion",
          "x-ui-order": 10,
          "required": ["distances", "color", "thickness", "show_labels"],
          "properties": {
            "distances": {
              "type": "array",
              "title": "Distances (km)",
              "items": { "type": "number", "minimum": 0.1, "maximum": 100 },
              "minItems": 1,
              "maxItems": 5,
              "default": [1.0, 5.0, 20.0],
              "description": "Distance rings in kilometers"
            },
            "color": { "$ref": "#/definitions/argb_color", "title": "Ring Color" },
            "thickness": { "type": "number", "title": "Thickness", "minimum": 0.5, "maximum": 10, "default": 1.5 },
            "show_labels": { "type": "boolean", "title": "Show Labels", "default": true },
            "label_font_size": { "type": "integer", "title": "Label Font Size", "minimum": 8, "maximum": 32, "default": 12 },
            "label_font": {
              "type": "string",
              "title": "Label Font",
              "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
              "default": "liberation_sans_bold"
            }
          }
        },
        "cardinals": {
          "type": "object",
          "title": "Cardinal Directions",
          "x-ui-level": "accordion",
          "x-ui-order": 20,
          "required": ["color", "font_size"],
          "properties": {
            "color": { "$ref": "#/definitions/argb_color", "title": "Color" },
            "font_size": { "type": "integer", "title": "Font Size", "minimum": 8, "maximum": 64, "default": 18 },
            "font": {
              "type": "string",
              "title": "Font",
              "enum": ["liberation_sans_bold", "b612_mono_bold", "share_tech_mono", "orbitron_bold"],
              "default": "liberation_sans_bold"
            }
          }
        },
        "fov_wedge": {
          "type": "object",
          "title": "Field of View Wedge",
          "x-ui-level": "accordion",
          "x-ui-order": 30,
          "description": "FOV angle is read from camera state at runtime, not configurable here",
          "required": ["fill_color", "outline_color", "outline_thickness"],
          "properties": {
            "fill_color": { "$ref": "#/definitions/argb_color", "title": "Fill Color", "description": "Semi-transparent fill for FOV wedge" },
            "outline_color": { "$ref": "#/definitions/argb_color", "title": "Outline Color" },
            "outline_thickness": { "type": "number", "title": "Outline Thickness", "minimum": 0.5, "maximum": 10, "default": 2.0 }
          }
        }
      }
    },
    "celestial_indicators": {
      "type": "object",
      "title": "Sun & Moon",
      "x-ui-level": "top",
      "x-ui-order": 50,
      "x-ui-collapsed": true,
      "description": "Celestial body indicators positioned on radar compass edge by azimuth, with size/opacity varying by altitude",
      "required": ["enabled", "show_sun", "show_moon", "scale", "visibility_threshold", "sun_svg", "moon_svg"],
      "properties": {
        "enabled": { "type": "boolean", "title": "Enabled" },
        "show_sun": { "type": "boolean", "title": "Show Sun" },
        "show_moon": { "type": "boolean", "title": "Show Moon" },
        "scale": {
          "type": "number",
          "title": "Scale",
          "minimum": 0.1,
          "maximum": 5.0,
          "description": "Base scale factor for celestial indicator size"
        },
        "visibility_threshold": {
          "type": "number",
          "title": "Visibility Threshold",
          "minimum": -90.0,
          "maximum": 90.0,
          "description": "Minimum altitude in degrees to show celestial body (negative shows bodies below horizon)"
        },
        "sun_svg": {
          "type": "string",
          "title": "Sun SVG",
          "description": "Path to sun indicator SVG",
          "x-ui-hidden": true
        },
        "moon_svg": {
          "type": "string",
          "title": "Moon SVG",
          "description": "Path to moon indicator SVG",
          "x-ui-hidden": true
        }
      }
    }
  },
  "definitions": {
    "argb_color": {
      "type": "string",
      "pattern": "^#[0-9A-Fa-f]{8}$",
      "description": "ARGB color in hex format (#AARRGGBB)"
    }
  }
}
